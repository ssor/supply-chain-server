### 一、使用websocket的方案

#### 1、获取供应链角色的属性数据(终端 -> 服务端)



```json
//使用场景：当终端设备识别出用户放置的角色条码时
{
  "type": 1,    //消息类型
  "roleID": 0   //系统预设的供应链角色ID，用来识别供应链节点的身份
}
```
具体角色编码, 即 roleID, 当前采用硬性编码 :

- 生产商  1-5

- 分销商  6-10

- 批发商  11-15

- 零售商 16-20

  



#### 2、下发供应链角色的属性数据(服务端 -> 终端)

```json
//使用场景：当服务端接收到 type == 0 的消息后
{
  "type": 2,                 //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,               //供应链角色ID，用来标识供应链节点的身份
  "maxInventory": 200,        //仓库的最大库存容量
  "currentInventory": 100,           //当前的库存数量 or 当前的已生产数量
  "gameStartTime": 1627388771  //当前实训的起始时间(Unix时间戳)
}
```
#### 3、下发客户订单数据(服务端 -> 零售商角色的终端)

```json
//使用场景：当服务端的订单服务生成订单后

//定义说明：MVP版本默认只有一种商品类型，不考虑由多种
//商品类型所组成的客户订单的情况，所以客户订单数据中只
//明确定义一种默认商品的购买数量
{
  "type": 3,                  //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,                //供应链角色ID，此处的ID一定是一个零售商类型的角色ID，因为只有零售商能接收客户订单
  "purchaseCnt": 1,           //购买数量，MVP版本这个数值设定为1
  "gameStartTime": 1627388771   //当前实训的起始时间(Unix时间戳)
}
```
#### 4、设置货运卡车的行驶目的地(终端 -> 服务端)

```json
//使用场景：当用户将货运卡车的条码放置在入库识别区域或者出库识别
//区域之后，终端会向服务端发送此消息，相当于将当前供应链角色的仓
//库位置设置为货运卡车的行驶目的地
{
  "type": 4,           //消息类型
   "gameID": "1627388771",        //实训ID
  "roleID": 0,         //供应链角色ID，用来标识供应链节点的身份
  "truckID": 20        //货运卡车ID，用来标识货运卡车的身份
}
```
#### 5、下发货运卡车的运载与相对位置数据(服务端 -> 终端)

```json
//使用场景：当货运卡车处于正在行驶的状态下，服务端每间隔一段时间向
//终端发送此消息，直到货运卡车抵达目的地为止
{
  "type": 5,                  //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,                //供应链角色ID，用来标识供应链节点的身份
  "truckID": 20,              //货运卡车ID，用来标识货运卡车的身份
  "tMaxQuantity": 40,         //货运卡车的最大装载容量
  "tQuantity": 15,            //货运卡车的当前已装载数量
  "remainingDistance": 26000, //货运卡车距离当前供应链节点的剩余里程，单位米
  "gameStartTime": 1627388771   //当前实训的起始时间(Unix时间戳)
}
```
#### 6、更新供应链节点的库存数据之出库(终端 -> 服务端)

```json
//使用场景：当用户将货运卡车的条码从入库识别区域或者出库识别区域
//拿走之时
{
  "type": 6,           //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,         //供应链角色ID，用来标识供应链节点的身份
  "truckID": 20,       //货运卡车ID，用来标识货运卡车的身份
  "tQuantity": 10      //货运卡车的当前已装载数量
}
```
#### 7、更新供应链节点的库存数据之二(零售商角色终端 -> 服务端)

```json
//使用场景：当零售商节点将商品出售时
{
  "type": 7,            //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,          //供应链角色ID，此处的ID是一个零售商类型的角色ID，因为只有零售商能接收客户订单
  "rQuantity": 20       //供应链节点的当前库存
}
```
#### 8、下发实验重置通知(服务端 -> 终端)

```json
//使用场景：当管理员在供应链实训系统的管理页面中执行了“重置实验”
//的操作后
{
  "type": 8,                  //消息类型
  "gameID": "1627388771",        //实训ID
  "roleID": 0,                //供应链角色ID，用来标识供应链节点的身份
  "gameStartTime": 1627388771   //当前实训的起始时间(Unix时间戳)
}
```
